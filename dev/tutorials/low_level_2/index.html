<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.453653713998571
 -3.6716909336232244
 -4.34280548602427
 -3.7876170521160017
 -3.941080862345547
 -3.8655705936813796
 -4.044607143055556
 -3.6159316335436404
 -3.866004918552456
 -3.605506136567151
  ⋮
 -3.9524980386262314
 -3.417786594407247
 -3.882958809622273
 -3.843438743964086
 -3.7222570470324294
 -4.081425053365136
 -3.976563013831916
 -3.957027804664692
 -4.19203964921833</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="50bf7c12.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.03570940414647136, 0.3414559085813407, 0.2885088089657212, -0.25390009233429645, -0.06804910829655786, -0.6061316514725008, -0.4689167931715871, 0.29839701239193567, -0.5551439231312587, -0.36565931910676774  …  -0.3554830602282009, -0.2131448984478185, -0.6359532325508813, 0.7067579294112571, 0.49070471363603124, 0.6655153706179411, 0.5800385619925645, -0.7688107840727753, -0.15245034995947634, 0.5003830075225038], [-0.03570940414647136, 0.3414559085813407, 0.2885088089657212, -0.25390009233429645, -0.06804910829655786, -0.6061316514725008, -0.4689167931715871, 0.29839701239193567, -0.5551439231312587, -0.36565931910676774  …  -0.3554830602282009, -0.2131448984478185, -0.6359532325508813, 0.7067579294112571, 0.49070471363603124, 0.6655153706179411, 0.5800385619925645, -0.7688107840727753, -0.15245034995947634, 0.5003830075225038], [-0.03570940414647136, 0.3414559085813407, 0.2885088089657212, -0.25390009233429645, -0.06804910829655786, -0.6061316514725008, -0.4689167931715871, 0.29839701239193567, -0.5551439231312587, -0.36565931910676774  …  -0.3554830602282009, -0.2131448984478185, -0.6359532325508813, 0.7067579294112571, 0.49070471363603124, 0.6655153706179411, 0.5800385619925645, -0.7688107840727753, -0.15245034995947634, 0.5003830075225038], [-0.027455296288143742, 0.34162349530833197, 0.2880873952860972, -0.2543477647882505, -0.06505581611379502, -0.6053230226001628, -0.4683401516140509, 0.300552995609133, -0.5555309293470736, -0.36602837702289787  …  -0.3544277601633719, -0.21383271214254285, -0.6367009564338302, 0.7098643009499027, 0.4940837283678527, 0.6673165336958631, 0.5809453270800715, -0.7703055791363583, -0.15670093021809975, 0.49997486839164956], [0.010930800754383373, 0.34310520398564487, 0.2862974422425672, -0.2575017875360597, -0.04513683582080308, -0.6005054293092201, -0.46394344270333365, 0.3153405299355898, -0.5558817376818267, -0.37043504716594594  …  -0.34401198550057976, -0.220549003947482, -0.6406793014187045, 0.7268864107730779, 0.5198523607172214, 0.6789153356019891, 0.5903380041468961, -0.779295610469783, -0.18513705802940122, 0.5008383130330167], [0.011630417585102231, 0.3434399292163708, 0.28600661340898226, -0.2578973135278849, -0.04311228814482767, -0.6000992856688114, -0.4633372469630978, 0.31672246651346175, -0.5559420975979869, -0.3708655538903511  …  -0.34307030253975956, -0.22083549799182214, -0.6407223992141327, 0.7285647040807268, 0.5224520655336578, 0.6803058641219696, 0.5915443278765329, -0.7805134272353251, -0.187460057093647, 0.5010434473128742], [0.011885382164416081, 0.34347089297564226, 0.28573371776203715, -0.25801047221059026, -0.04268743239206274, -0.6000371641877726, -0.4633130035483502, 0.31692931268685653, -0.5559928993261325, -0.37098667534884167  …  -0.3425666109377272, -0.22106571532827304, -0.6407620660874339, 0.7291234903224182, 0.5230958922627859, 0.6805862711099075, 0.591939195959773, -0.780684953062095, -0.18833655431652704, 0.5010349552375694], [0.011867149674806014, 0.3433850003435638, 0.28563621870897615, -0.2580492540753807, -0.042657250573729176, -0.5999076515462751, -0.46321367848742984, 0.3169335901938176, -0.5559726891494436, -0.3710003684275324  …  -0.3425313398782431, -0.22102008102874307, -0.6408891969356839, 0.7293017601035805, 0.5232648099473756, 0.6806001371474125, 0.5921469075202661, -0.7807285524687401, -0.1884983926776686, 0.5010413846127264], [0.012217924961712815, 0.34340688780265854, 0.2856793430247099, -0.2581513632467706, -0.04234419823251323, -0.599911456139125, -0.46301964405419055, 0.3169734563010775, -0.5559326927508508, -0.37118788817784903  …  -0.34216319473397055, -0.221184108221628, -0.6410134843472848, 0.7295055229850033, 0.5235743805986235, 0.6807840164539977, 0.5923678212401259, -0.7808538097634325, -0.18879962827372024, 0.5010180665727605], [0.012426236169359244, 0.34345694030534574, 0.285750032336204, -0.2582460309681829, -0.04216723366765182, -0.5997270833748494, -0.4630249130899023, 0.3171797460391927, -0.5558206435059232, -0.3713117979639074  …  -0.34194800550390186, -0.22120481797948607, -0.6411288536592968, 0.7298217014366593, 0.523883815963035, 0.6810223748083427, 0.5925591442462025, -0.7809306896811594, -0.18936192199997143, 0.5009380900112165]  …  [0.32677467373755803, 1.1327904515108158, 0.471196545965861, -0.6862698853371808, 0.0031288508329092913, -0.5176458017187094, -0.7992580437250353, 0.6313504817983889, -0.6258981078164914, -0.6573206809075256  …  -0.15641249870865606, -1.3943063331668464, -2.0485031410762344, 2.6367230089691174, 2.6065605594144836, 2.30982960177153, 2.04538042424683, -2.2358444685481875, 0.2852059325853472, 0.3359360983374069], [0.3243449774381332, 1.1331478844223497, 0.47044425745595203, -0.6840324982617048, 0.00528388078452581, -0.5152458224145117, -0.7992071220497595, 0.6315375760326175, -0.6282442344365708, -0.6581353929508642  …  -0.15646594506610598, -1.3945664625786311, -2.0492481886997, 2.6357807885325606, 2.6072467983566217, 2.3088287431437746, 2.044067779921705, -2.2362627300692712, 0.28685873070098017, 0.33655908663709017], [0.32046849871588906, 1.1334049284201795, 0.4665453838367242, -0.680933216343346, 0.006778959928760938, -0.5113494537803684, -0.7984854263722575, 0.6302630767334849, -0.6303444079232641, -0.6600775604529644  …  -0.15704000240171534, -1.394810689200832, -2.050662994551594, 2.6365486682455934, 2.6077563616578257, 2.310126454652061, 2.045133441549742, -2.2362502174688212, 0.28827313049341674, 0.33719625907132134], [0.31651354972361617, 1.1341626255170698, 0.46250510714362153, -0.6756333079488159, 0.0081987388025043, -0.5063930055787157, -0.7979260861673029, 0.6320095994336782, -0.635006186703125, -0.6628720581613343  …  -0.15825626986181845, -1.3944976378840386, -2.0506691175619722, 2.6362317589812467, 2.6073059175779765, 2.3110821300163393, 2.0459392259105953, -2.2373998676795663, 0.2904113446130382, 0.3373384106265813], [0.3160643105953628, 1.1340250140538986, 0.46232671045502355, -0.6753797391349294, 0.007954930733233735, -0.506031143138889, -0.7983192422545209, 0.6321824337142418, -0.6354676527209232, -0.6635286627375522  …  -0.15861943855493488, -1.3945560947463218, -2.050567744524829, 2.636488230732794, 2.6071708665931315, 2.311110622546124, 2.0458983158880626, -2.2378292474663435, 0.28992388932574203, 0.33719472240377835], [0.314598023906966, 1.1324625911071222, 0.4621597728325432, -0.673138091935943, 0.00829672702102467, -0.5046661025811409, -0.7977697215515828, 0.6327829570829023, -0.6365857763463871, -0.6649565625915302  …  -0.15864866643383654, -1.3952587502203473, -2.0501177611979107, 2.6371237430447363, 2.607383560826097, 2.311562465998534, 2.0462975602646862, -2.23757978008696, 0.2909555309829766, 0.33702970773109947], [0.3050497369530524, 1.1323081190524078, 0.45200272004386766, -0.6627290020212651, 0.011421625415368515, -0.49640693577403217, -0.7987629405077011, 0.6384979206252025, -0.6458368293399459, -0.6765877791722934  …  -0.15770159171323603, -1.4031009049510166, -2.054665222059382, 2.6411112358135127, 2.6096021021748586, 2.317641264151338, 2.0499980078495925, -2.2424440433755484, 0.29809471147546274, 0.338036673043904], [0.29322844898780714, 1.1280691570089625, 0.4347523157483751, -0.6483870200177645, 0.012545743996254025, -0.49187726299647955, -0.7986798563206879, 0.6484892216036575, -0.6572771423739963, -0.6980046076584091  …  -0.1585679427574259, -1.4180237527706672, -2.064984133646191, 2.649025808350465, 2.617189688698688, 2.337648018414713, 2.056584017662941, -2.248866575013892, 0.31430396694500845, 0.3425863522669783], [0.29275845311579185, 1.1273220174795249, 0.4314312247664874, -0.645298058646133, 0.012869443081484841, -0.4906141261854752, -0.7965785883451534, 0.6497128419777429, -0.6592838631230146, -0.7011299668550378  …  -0.1601979271053057, -1.418467765017763, -2.067605517468605, 2.6511886449389857, 2.6176905262078405, 2.340828384326007, 2.0577472315993415, -2.250451249822602, 0.3153002142070877, 0.34450388289929834], [0.29410978402758103, 1.125451831822157, 0.42970595183221216, -0.6436949416227998, 0.015284497315305741, -0.489095650309426, -0.7969255491620549, 0.6513660601772635, -0.6607179414373121, -0.7043506807759535  …  -0.1598731105583346, -1.4186959865537743, -2.069380395014461, 2.6520153474529113, 2.6204061959077265, 2.342210344960032, 2.0590031907107007, -2.251337540862759, 0.31886401376752227, 0.3458296124449724]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.5728150070828567e6, hamiltonian_energy = 1.6927948625895744e6, hamiltonian_energy_error = -16242.26792735653, max_hamiltonian_energy_error = 198447.44000476273, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5728150070828567e6, hamiltonian_energy = 1.572861021869895e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6.854979455980683e37, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5728150070828567e6, hamiltonian_energy = 1.572864760929911e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 55575.75050019473, tree_depth = 0, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.5661035953762692e6, hamiltonian_energy = 1.5728460931416634e6, hamiltonian_energy_error = -16.14719404443167, max_hamiltonian_energy_error = -16.14719404443167, tree_depth = 2, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.683509983531322, log_density = -1.5260888902094427e6, hamiltonian_energy = 1.5661040584994871e6, hamiltonian_energy_error = -39.7359124973882, max_hamiltonian_energy_error = 128.5685297998134, tree_depth = 4, numerical_error = false, step_size = 0.0001955224279177154, nom_step_size = 0.0001955224279177154, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.8849541351454997, log_density = -1.5225979488558928e6, hamiltonian_energy = 1.5261412303887706e6, hamiltonian_energy_error = 0.11110634193755686, max_hamiltonian_energy_error = 0.2744120815768838, tree_depth = 2, numerical_error = false, step_size = 0.00011418324763407563, nom_step_size = 0.00011418324763407563, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.5691463454485487, log_density = -1.5215402788813396e6, hamiltonian_energy = 1.5226522165873752e6, hamiltonian_energy_error = 0.2436068702954799, max_hamiltonian_energy_error = 1.2621725529897958, tree_depth = 2, numerical_error = false, step_size = 0.00012969864083663767, nom_step_size = 0.00012969864083663767, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9606477267176435, log_density = -1.5212917113410186e6, hamiltonian_energy = 1.5216021279745859e6, hamiltonian_energy_error = 0.030242336681112647, max_hamiltonian_energy_error = 0.09169129352085292, tree_depth = 2, numerical_error = false, step_size = 5.839166736379859e-5, nom_step_size = 5.839166736379859e-5, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.1446938448090339, log_density = -1.5207408152736921e6, hamiltonian_energy = 1.5213587950501968e6, hamiltonian_energy_error = 0.0975125387776643, max_hamiltonian_energy_error = 32.722371831769124, tree_depth = 5, numerical_error = false, step_size = 9.165963050435436e-5, nom_step_size = 9.165963050435436e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9987158944323223, log_density = -1.5200695251854851e6, hamiltonian_energy = 1.5207821852800946e6, hamiltonian_energy_error = 0.0019005793146789074, max_hamiltonian_energy_error = 0.0039061326533555984, tree_depth = 4, numerical_error = false, step_size = 1.1289176437338882e-5, nom_step_size = 1.1289176437338882e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -31507.537775374156, hamiltonian_energy = 31992.792133242092, hamiltonian_energy_error = -0.2505577783413173, max_hamiltonian_energy_error = -0.8146597847480734, tree_depth = 4, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9986155753075425, log_density = -30747.985534025884, hamiltonian_energy = 31578.608584348385, hamiltonian_energy_error = -0.2761644280726614, max_hamiltonian_energy_error = -0.8075120883258933, tree_depth = 4, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -29712.17700238702, hamiltonian_energy = 30800.203351509266, hamiltonian_energy_error = -0.38567599612724734, max_hamiltonian_energy_error = -0.7265976357193722, tree_depth = 4, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -28275.305454245696, hamiltonian_energy = 29769.475289485126, hamiltonian_energy_error = -0.39487530161932227, max_hamiltonian_energy_error = -0.40886097394832177, tree_depth = 4, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -28148.186122949148, hamiltonian_energy = 28313.44970098613, hamiltonian_energy_error = -0.079109082762443, max_hamiltonian_energy_error = -0.17911008629744174, tree_depth = 4, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9984499512520041, log_density = -27660.741658997904, hamiltonian_energy = 28202.297555256522, hamiltonian_energy_error = -0.1165491812316759, max_hamiltonian_energy_error = -0.2812867440698028, tree_depth = 4, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9976599025194549, log_density = -24852.420554969354, hamiltonian_energy = 27711.94521242835, hamiltonian_energy_error = -0.566447599001549, max_hamiltonian_energy_error = -0.679612138421362, tree_depth = 5, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 127, is_accept = true, acceptance_rate = 0.99991951755485, log_density = -20885.767174861212, hamiltonian_energy = 24910.364929412346, hamiltonian_energy_error = -0.5448001713230042, max_hamiltonian_energy_error = -0.935123518036562, tree_depth = 7, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9948562328377585, log_density = -20402.003381326274, hamiltonian_energy = 20945.888367850694, hamiltonian_energy_error = -0.05043514885255718, max_hamiltonian_energy_error = -0.12921824531440507, tree_depth = 5, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9938141351062919, log_density = -19997.543666723013, hamiltonian_energy = 20468.288202135478, hamiltonian_energy_error = -0.0286949228393496, max_hamiltonian_energy_error = -0.07197869871743023, tree_depth = 5, numerical_error = false, step_size = 7.328378635174005e-5, nom_step_size = 7.328378635174005e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18, -3.62 ± 0.18  …  -4.43 ± 0.12, -4.43 ± 0.12, -4.43 ± 0.12, -4.43 ± 0.12, -4.43 ± 0.12, -4.43 ± 0.12, -4.43 ± 0.12, -4.43 ± 0.13, -4.42 ± 0.13, -4.42 ± 0.13]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.249 ± 0.097 -0.635 ± 0.014; 0.876 ± 0.31 -0.655 ± 0.017; … ; -0.724 ± 0.092 0.446 ± 0.29; 0.645 ± 0.015 -1.21 ± 0.096], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.261 ± 0.17; -0.49 ± 0.018; … ; -0.542 ± 0.11; -0.602 ± 0.22;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.378 ± 0.0014 0.0714 ± 0.024 … -0.169 ± 0.021 -0.351 ± 0.042; -0.0098 ± 0.0074 0.463 ± 0.062 … 0.387 ± 0.043 0.606 ± 0.087; … ; 0.508 ± 0.031 -0.23 ± 0.061 … -0.712 ± 0.077 -0.914 ± 0.085; -0.714 ± 0.045 -0.288 ± 0.064 … 0.688 ± 0.074 0.244 ± 0.041], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.123 ± 0.031; 0.0385 ± 0.061; … ; -0.106 ± 0.018; -0.272 ± 0.032;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.13 ± 0.033 -1.13 ± 0.33 … 1.77 ± 0.34 -1.97 ± 0.33], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.00477 ± 0.36;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.402 ± 0.079], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="e15fa012.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 23 January 2024 13:01">Tuesday 23 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
